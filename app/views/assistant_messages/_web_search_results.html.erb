<%# locals: (search_data:) %>

<div class="flex items-start gap-3 my-4">
  <div class="shrink-0 w-8 h-8 rounded-lg bg-gradient-to-br from-cyan-400 via-blue-500 to-purple-600 flex items-center justify-center" style="filter: drop-shadow(0px 6px 8px rgba(244, 78, 247, 0.10));">
    <%= icon("globe", size: "sm", class: "text-white") %>
  </div>

  <div class="flex-1 max-w-[85%]">
    <div class="flex items-center gap-2 mb-3">
      <span class="text-sm font-medium text-secondary">
        Web Search: "<%= search_data[:query] %>"
      </span>
      <span class="text-xs text-subdued">
        (<%= search_data[:result_count] %> results)
      </span>
    </div>

    <div class="space-y-3">
    <% search_data[:results].each do |result| %>
      <a href="<%= result[:url] %>"
         target="_blank"
         rel="noopener noreferrer"
         class="block p-4 bg-container-inset rounded-xl border border-primary/10 hover:border-primary/30 hover:bg-container transition-all group">

        <div class="flex items-start gap-3">
          <div class="flex-shrink-0 w-8 h-8 rounded-lg bg-container flex items-center justify-center">
            <%= icon("external-link", size: "sm", class: "text-secondary group-hover:text-primary transition-colors") %>
          </div>

          <div class="flex-1 min-w-0">
            <h4 class="text-sm font-medium text-primary line-clamp-2 group-hover:text-link transition-colors">
              <%= result[:title] || "Untitled" %>
            </h4>

            <p class="text-xs text-subdued mt-1 truncate">
              <%= URI.parse(result[:url]).host rescue result[:url] %>
              <% if result[:published_date].present? %>
                <span class="mx-1">&middot;</span>
                <%= Date.parse(result[:published_date]).strftime("%b %d, %Y") rescue result[:published_date] %>
              <% end %>
              <% if result[:author].present? %>
                <span class="mx-1">&middot;</span>
                <%= result[:author] %>
              <% end %>
            </p>

            <% if result[:summary].present? %>
              <p class="text-sm text-secondary mt-2 line-clamp-3">
                <%= result[:summary] %>
              </p>
            <% elsif result[:highlights].present? && result[:highlights].any? %>
              <p class="text-sm text-secondary mt-2 line-clamp-3">
                <%= result[:highlights].first %>
              </p>
            <% end %>
          </div>
        </div>
      </a>
    <% end %>
    </div>

    <div class="mt-3 text-xs text-subdued flex items-center gap-1">
      <%= icon("info", size: "xs", class: "text-subdued") %>
      <span>Results from Exa AI search. Click to view original source.</span>
    </div>
  </div>
</div>
