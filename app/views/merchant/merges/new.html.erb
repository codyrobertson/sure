<%= render DS::Dialog.new do |dialog| %>
  <% dialog.with_header(title: t(".title"), subtitle: t(".subtitle", count: @merchants.size)) %>

  <% dialog.with_body do %>
    <%= styled_form_with url: merchant_merge_path, data: { turbo_frame: "_top" } do |form| %>
      <div class="space-y-4">
        <p class="text-sm text-secondary"><%= t(".explanation") %></p>

        <div class="rounded-lg bg-container-inset p-3 space-y-2">
          <p class="text-xs font-medium text-secondary uppercase"><%= t(".merging") %></p>
          <ul class="space-y-1">
            <% @merchants.each do |merchant| %>
              <%= form.hidden_field :merchant_ids, multiple: true, value: merchant.id %>
              <li class="flex items-center gap-2">
                <span class="w-3 h-3 rounded-full" style="background-color: <%= merchant.color %>"></span>
                <span class="text-sm text-primary"><%= merchant.name %></span>
                <span class="text-xs text-secondary">(<%= merchant.transactions.count %> <%= t(".transactions") %>)</span>
              </li>
            <% end %>
          </ul>
        </div>

        <%= form.collection_select :target_merchant_id,
                                  @available_merchants,
                                  :id, :name,
                                  { prompt: t(".select_target"), label: t(".target_merchant") } %>
      </div>

      <div class="flex justify-end gap-2 mt-6">
        <%= render DS::Button.new(text: t(".cancel"), variant: "ghost", data: { action: "click->DS--dialog#close" }) %>
        <%= render DS::Button.new(text: t(".merge"), variant: "primary") %>
      </div>
    <% end %>
  <% end %>
<% end %>
